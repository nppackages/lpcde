ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
# processing data script
x=0
filename = "../outputs/processed_data/pdf_table_x_int_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
# processing data script
x=0
filename = "../outputs/processed_data/pdf_table_x_int_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
5.72/sqrt(2000)
0.64/sqrt(2000)
1.2/sqrt(2000)
2.03/sqrt(2000)
3.62/sqrt(2000)
1/sqrt(2000)
1.83/sqrt(2000)
3.23/sqrt(2000)
5.64/sqrt(2000)
1.84/sqrt(2000)
3.27/sqrt(2000)
5.72/sqrt(2000)
# setting parameters
n = 5000
num_sims = 1000
ng = 20
CIsimul=2000
alpha=0.05
x =0
# y_grid = seq(stats::quantile(y_data)[2], stats::quantile(y_data)[4], length.out=ng)
# y_grid = seq(0, 2, length.out=ng)
# y_grid = c(0)
y_grid = seq(0, 1.0, length.out=ng)
# initializing
bias = matrix(0L, nrow = ng, ncol = num_sims)
aw_pw = ucb = aw_u = ci_size = cb_size = se = sd = bias
bias_rbc = sd_rbc = ci_rbc_l = ci_rbc_u = aw_pw_rbc = cb_rbc_l = cb_rbc_u = aw_u_rbc = ci_size_rbc = cb_size_rbc = bias
ucb = pw = matrix(0L, nrow=1, ncol=num_sims)
# Using parallel computations for simulations
library(parallel)
numCores = detectCores()
# set numCores to use all available cores
numCores
# simulating data
data = mvtnorm::rmvnorm(5*n, sigma = matrix(c(2, -0.1, -0.1, 2), nrow=2))
data = data[abs(data[,1])<=1.6,]
data = data[abs(data[,2])<=1.6,]
data = data[1:n, ]
# y_data = as.matrix(stats::rnorm(5*n, mean = -0.1*x, sd=sqrt(1-0.1^2)))
x_data = as.matrix(data[, 2])
y_data = as.matrix(data[, 1])
x_data
# bandwidth selection
bw_star = lpcde::lpbwcde(y_data=y_data, x_data=x_data, y_grid=y_grid, x=x,
p=3, mu=2, bw_type="mse-rot")$BW[,2]
bw_star
# true parameters
true_val = -(y_grid)*exp(-0.5 * (y_grid)^2)/sqrt(2*pi)
# estimating density
est = lpcde::lpcde(y_data=y_data, x_data=x_data, y_grid=y_grid, x=x, mu=2, p=3,
bw=bw_star, var_type="ustat")
# estimating density
est = lpcde::lpcde(y_data=y_data, x_data=x_data, y_grid=y_grid, x=x, mu=2, p=3,
bw=bw_star)
x=0
filename = "../outputs/processed_data/pdf_table_x_int_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
x=0.7
filename = "../outputs/processed_data/pdf_table_x_nb_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_nb_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_nb_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
x=1
filename = "../outputs/processed_data/pdf_table_x_bnd_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_bnd_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_bnd_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.3*x, sd=sqrt(1-0.3^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
x=0
filename = "../outputs/processed_data/pdf_table_x_int_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
x=0
filename = "../outputs/processed_data/pdf_table_x_int_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))/(pnorm(1.2)-pnorm(-1.2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
x=0
filename = "../outputs/processed_data/pdf_table_x_int_y_int.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_nb.csv"
dataset = load(file=filename)
filename = "../outputs/processed_data/pdf_table_x_int_y_bnd.csv"
dataset = load(file=filename)
y=0
# true_dens = dnorm(0)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
#ustat var
table_data_ustat = matrix(c(mean(int_avg[,1]), mean(int_avg[,2])), nrow=1)
bias_ustat = (int_avg[,3]-true_dens)
bias_ustat_rbc = (int_avg[,4]-true_dens)
se_ustat = int_avg[, 5]
se_ustat_rbc = int_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = cbind(table_data_ustat, abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc))
colnames(table_data_ustat) = c("bw", "eff_n", "bias", "se", "CE", "CE_rbc", "AW", "AW_rbc")
y=0.7
# true_dens = dnorm(0.7)/(pnorm(1.2)-pnorm(-1.2))
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))/(pnorm(1.2)-pnorm(-1.2))
bias_ustat = (nb_avg[,3]-true_dens)
bias_ustat_rbc = (nb_avg[,4]-true_dens)
se_ustat = nb_avg[, 5]
se_ustat_rbc = nb_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(nb_avg[,1]), mean(nb_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
y=1
# true_dens = dnorm(1)
true_dens = stats::dnorm(y, mean = -0.1*x, sd=sqrt(1-0.1^2))
bias_ustat = (bnd_avg[,3]-true_dens)
bias_ustat_rbc = (bnd_avg[,4]-true_dens)
se_ustat = bnd_avg[, 5]
se_ustat_rbc = bnd_avg[, 6]
ce_ustat = 100*mean(ifelse(abs(bias_ustat/se_ustat)<1.96, 1, 0))
ce_ustat_rbc = 100*mean(ifelse(abs(bias_ustat_rbc/se_ustat_rbc)<1.96, 1, 0))
aw_ustat = 2*1.96*se_ustat
aw_ustat_rbc = 2*1.96*se_ustat_rbc
table_data_ustat = rbind(table_data_ustat, c(mean(bnd_avg[,1]), mean(bnd_avg[,2]),
abs(mean(bias_ustat)), mean(se_ustat),
ce_ustat, ce_ustat_rbc, mean(aw_ustat), mean(aw_ustat_rbc)))
table_data_ustat
library(lpcde)
library(lpcde)
library(lpcde)
library(lpcde)
library(lpcde)
